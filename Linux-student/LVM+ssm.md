# LVM

LVM（逻辑卷管理，Logical Volume Manager）是一种 **磁盘管理软件**，它属于操作系统的一部分，用于灵活地管理磁盘存储空间。简单来说，LVM 是一种 **逻辑上的磁盘管理工具**，而不是物理硬件。

# 特点：

1. **动态管理**：可以动态调整磁盘分区的大小，而无需重新分区或重启系统。
2. **虚拟化存储**：将多个物理磁盘组合成一个“虚拟磁盘”，方便管理和扩展。
3. **动态扩展**：支持添加新磁盘或扩展现有磁盘的空间。
   - **扩展存储池**：插入新硬盘后，直接将它加入池子，池子总容量就变大了。
   - **扩展逻辑卷**：如果某个分区（逻辑卷，LV）空间不足，可以直接从池子里“切一块”空间给它，而无需停机或迁移数据。



# LVM的基本组成部分

- **物理卷（Physical Volume, PV）**  
  物理卷是LVM的基础单元，通常是一个硬盘分区或整个硬盘。它是LVM能够识别和管理的物理存储设备。

- **卷组（Volume Group, VG）**  
  卷组是由一个或多个物理卷组成的逻辑存储池。卷组可以看作是一个“虚拟磁盘”，管理员可以在其中分配空间。

- **逻辑卷（Logical Volume, LV）**  
  逻辑卷是从卷组中划分出来的逻辑存储单元，相当于传统分区。逻辑卷上可以创建文件系统（如ext4、xfs等），并挂载到目录中使用。

- ****PE（Physical Extent，物理扩展块）****
  
  **定义**：  
  PE 是物理卷（Physical Volume, PV）被划分后的最小存储单元。当物理卷加入卷组（Volume Group, VG）时，会被分割成多个大小固定的 PE。
  
  **特点**：
  
  - PE 的大小在创建卷组时确定（例如 4MB、8MB 等），且同一卷组中的所有物理卷使用相同的 PE 大小。
  
  - 物理卷的存储空间以 PE 为单位分配给逻辑卷（Logical Volume, LV）。

- **LE（Logical Extent，逻辑扩展块）**
  
  **定义**：  
  LE 是逻辑卷（Logical Volume, LV）被划分后的最小存储单元。LE 的大小与所属卷组的 PE 大小一致。
  
  **特点**：
  - 逻辑卷的存储空间由多个 LE 组成，每个 LE 会映射到物理卷的一个 PE（或镜像场景中的多个 PE）。
  - LE 是逻辑卷操作的基本单位，例如扩展或缩减逻辑卷时，实际是增加或减少 LE 的数量。

# 创建lvm的基本步骤

**1.物理磁盘被格式化为PV,(空间被划分为一个个的P)**
#PV包含PE

****2.不同的PV加入到同一个VG中，（不同PV的PE全部进入到了VG的PE池内）****
#VG包含PV

**3.在VG中创建LV逻辑卷，基于PE创建，（组成LV的PE可能来自不同的物理磁盘）**
#LV基于PE创建

**4.LV直接可以格式化后挂载使用**
#格式化挂载使用

> LV的扩充缩减实际上就是增加或减少组成该LV的PE数量，其过程不会丢失原始数据

# 命令

| 功能        | PV管理命令    | VG管理命令    | LV管理命令    |
| --------- | --------- | --------- | --------- |
| scan扫描    | pvscan    | vgscan    | Ivscan    |
| create 创建 | pvcreate  | vgcreate  | Ivcreate  |
| display显示 | pvdisplay | vgdisplay | Ivdisplay |
| remove移除  | pvremove  | vgremove  | Ivremove  |
| extend扩展  |           | vgextend  | lvextend  |
| reduce减少  |           | vgreduce  | Ivreduce  |


